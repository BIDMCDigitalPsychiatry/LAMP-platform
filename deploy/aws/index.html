<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LAMP Platform RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="LAMP Platform Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-192736629-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Preparing Resources on AWS | LAMP Platform</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://docs.lamp.digital/logo.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.lamp.digital/logo.png"><meta data-react-helmet="true" property="og:url" content="https://docs.lamp.digital/deploy/aws"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Preparing Resources on AWS | LAMP Platform"><meta data-react-helmet="true" name="description" content="The following instructions will result in a Docker Swarm setup prepared to deploy LAMP. You will need to continue following the instructions after this phase to successfully configure LAMP."><meta data-react-helmet="true" property="og:description" content="The following instructions will result in a Docker Swarm setup prepared to deploy LAMP. You will need to continue following the instructions after this phase to successfully configure LAMP."><link data-react-helmet="true" rel="shortcut icon" href="/./docs/assets/logo.png"><link data-react-helmet="true" rel="canonical" href="https://docs.lamp.digital/deploy/aws"><link data-react-helmet="true" rel="alternate" href="https://docs.lamp.digital/deploy/aws" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.lamp.digital/deploy/aws" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.79aa5778.css">
<link rel="preload" href="/assets/js/runtime~main.d014a8c0.js" as="script">
<link rel="preload" href="/assets/js/main.b6df9aae.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo.png" alt="LAMP Platform" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/logo.png" alt="LAMP Platform" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">LAMP Platform</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" href="/">User Guide</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/app">Download App</a></li><li><a class="dropdown__link" href="/bug">Report Bug</a></li><li><a class="dropdown__link" href="/faq">FAQ</a></li></ul></div><a class="navbar__item navbar__link" href="/api">API</a><a class="navbar__item navbar__link" href="/blog">What&#x27;s New</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://mindlamp.discourse.group/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Forum<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/BIDMCDigitalPsychiatry/LAMP-platform/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="mailto:team@digitalpsych.org" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Contact<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">LAMP Platform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Links</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Users and Publications</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How to use mindLAMP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Setting up mindLAMP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Deploying LAMP</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/prereqs">Prerequisites for Deploying the LAMP Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/recs">Deployment Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/costs">Costs of Deploying the LAMP Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/provisioning">Provisioning the LAMP Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/deploy/aws">Preparing Resources on AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/cloudformation">Deploying via CloudFormation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/deploying">Deploying the LAMP Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/testing">Testing the LAMP Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/deploy/troubleshooting">Troubleshooting Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developing LAMP</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cortex &amp; API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Consortium</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/troubleshooting">Troubleshooting</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Preparing Resources on AWS</h1></header><p>The following instructions will result in a Docker Swarm setup prepared to deploy LAMP. You will need to continue following the instructions after this phase to successfully configure LAMP.</p><p><img src="/assets/images/Untitled_AWS-3d6dab11c58abe7d166f0f2215a33889.png"></p><p><em>Digital Psychiatry&#x27;s AWS Network Diagram for the LAMP Platform</em></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="for-ec2-instances-only">For EC2 Instances Only:<a aria-hidden="true" class="hash-link" href="#for-ec2-instances-only" title="Direct link to heading">â€‹</a></h3><p>A <strong>HARD</strong> requirement for the successful operation of the LAMP Platform is the use of a high performance SSD volume. For more information on these hard limitations and requirements, <a href="https://docs.mongodb.com/manual/administration/production-notes/" target="_blank" rel="noopener noreferrer">see the MongoDB documentation here.</a></p><ol><li>Required maximum (saturable) disk bandwidth: <code>4750 Mbps</code></li><li>Required maximum disk throughput: <code>593.75 MB/s</code></li><li>Required maximum disk I/O operations: <code>20000 IOPS</code></li><li>Required minimum disk throughput: <code>125 MB/s</code></li><li>Required minimum disk I/O operations: <code>3000 IOPS</code></li><li>Required minimum disk space: <code>64 GB</code></li></ol><p>If using AWS, provisioning a DocumentDB cluster is the simplest way to achieve these baseline requirements for efficient and accurate data collection with no database outages or upload rejections. </p><p><strong>You must replace the value of <code>MY_DNS_NAME</code> in the commands below.</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI markdown"><pre tabindex="0" class="prism-code language-markdown codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token list punctuation" style="color:rgb(199, 146, 234)">1.</span><span class="token plain"> Create an EC2 instance.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; AMI: AWS Linux 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Instance Type: [MINIMUM] t2.medium</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Create a new IAM role with the </span><span class="token code-snippet code keyword" style="font-style:italic">`AmazonSSMManagedInstanceCore`</span><span class="token plain"> policy.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Enable termination protection.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Create a [RECOMMENDED] 1TB EBS volume WITH encryption enabled.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Configure security group:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; HTTP: TCP 80 from anywhere</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; HTTPS: TCP 443 from anywhere</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Daemon: TCP 2375 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Machine: TCP 2376 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Swarm: TCP 2377 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Swarm: TCP 7946 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Swarm: UDP 7946 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        -&gt; Docker Overlay: UDP 4789 from this Security Group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Create a new key pair and keep it private.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                -&gt; Allocate and assign an elastic IP to the instance.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token list punctuation" style="color:rgb(199, 146, 234)">2.</span><span class="token plain"> Run the following commands in the instance.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo yum -y update &amp;&amp; sudo yum -y install docker -y</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo usermod -a -G docker ec2-user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo hostnamectl set-hostname </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">MY_DNS_NAME</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo printf &quot;[Service]\nExecStart=\nExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H fd:// --containerd=/run/containerd/containerd.sock\n&quot; | sudo tee /etc/systemd/system/docker.service.d/override.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo systemctl daemon-reload &amp;&amp; sudo service docker restart</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                sudo docker swarm init</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token list punctuation" style="color:rgb(199, 146, 234)">3.</span><span class="token plain"> Create your DNS binding in Route53.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ec2-commands">EC2 Commands<a aria-hidden="true" class="hash-link" href="#ec2-commands" title="Direct link to heading">â€‹</a></h3><p>The following is a set of bash commands to be used from within AWS Systems Manager once a new EC2 instance and EBS volume are created with the AWS SSM IAM role.</p><p><strong>DO NOT USE THIS AS A SCRIPT!
THOROUGHLY READ IT AND RUN EACH COMMAND INDIVIDUALLY!
SUBSTITUTE ALL VARIABLES BEFORE CONTINUING!</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Assumes nvme1n1 is the name of the EBS volume. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Use lsblk to confirm this before running the script.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Attach EBS volume and configure auto-reattach on restart.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkfs</span><span class="token plain"> -t xfs /dev/nvme1n1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /data </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> /dev/nvme1n1 /data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">printf</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string" style="color:rgb(195, 232, 141)">UUID=</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">blkid -s UUID -o value /dev/nvme1n1</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">     /data       xfs    defaults,nofail   0   2&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/fstab</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">umount</span><span class="token plain"> /data </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Install Docker and move Docker root to EBS volume.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /data/var/lib/docker </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ln</span><span class="token plain"> -s /data/var/lib/docker /var/lib/docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Set hostname before starting Docker and join the Swarm.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hostnamectl set-hostname node-01.example.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> start</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> swarm </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> --token SWARM_TOKEN IP_ADDR:2377</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>In case your EBS volume runs out of storage space, follow the instructions below:</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># expand the EBS volume using the AWS management console first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsblk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">growpart /dev/nvme1n1 </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">xfs_growfs -d /data</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="aws-ssm-instructions">AWS SSM Instructions<a aria-hidden="true" class="hash-link" href="#aws-ssm-instructions" title="Direct link to heading">â€‹</a></h3><p>We recommend disabling all SSH (port 22) or remote access to any EC2 instances you configure. <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-start.html#start-ec2-console" target="_blank" rel="noopener noreferrer">Use AWS Systems Session Manager (AWS SSM) to access your node.</a> Additionally, follow the instructions below on your local computer to securely communicate with the instance(s).</p><ol><li><p><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-install-plugin.html" target="_blank" rel="noopener noreferrer">Install the AWS CLI SSM plugin.</a></p></li><li><p><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-enable-ssh-connections.html" target="_blank" rel="noopener noreferrer">Configure SSH to support AWS SSM tunneling.</a></p></li><li><p>Alternatively, manually open a port forwarding tunnel.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws ssm start-session </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --target </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">aws ec2 describe-instances </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --filter </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;Name=tag:Name,Values=node-01&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --query </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;Reservations[].Instances[?State.Name == &#x27;running&#x27;].InstanceId[]&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --output text</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --document-name AWS-StartPortForwardingSession </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --parameters </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{ &quot;portNumber&quot;: [&quot;22&quot;], &quot;localPortNumber&quot;: [&quot;9999&quot;] }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Alternatively, manually open a secure SSH tunnel session.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws ssm start-session </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --target </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">aws ec2 describe-instances </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --filter </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;Name=tag:Name,Values=node-01&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --query </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;Reservations[].Instances[?State.Name == &#x27;running&#x27;].InstanceId[]&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token variable" style="color:rgb(191, 199, 213)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(191, 199, 213)">        --output text</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --document-name AWS-StartSSHSession </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --parameters </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;portNumber=%p&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="using-aws-documentdb-instead-of-mongodb-coming-soon">Using AWS DocumentDB instead of MongoDB (Coming Soon)<a aria-hidden="true" class="hash-link" href="#using-aws-documentdb-instead-of-mongodb-coming-soon" title="Direct link to heading">â€‹</a></h3><p>The Division of Digital Psychiatry has been working closely with Solutions Architects at Amazon Web Services (AWS) to improve performance and reliability, as well as reduce maintenance overhead and IT skills required for deployment. For this reason, we support MongoDB in addition to the Apache CouchDB database. AWS offers a managed solution for MongoDB databases called DocumentDB that abstracts and simplifies all MongoDB database setup and operations needs, including routine backups and HIPAA-compliant encryption of data at rest and in transit. </p><p>DocumentDB is a high performance database solution built on the AWS Aurora technology that supports global replicated clusters that span across multiple regions (i.e. U.S. East and Mumbai, for example) and up to 15 read replicas in a single region. This provides high availability and performance for the LAMP API and in turn the clinical dashboard and mobile apps that are built upon it. </p><p>This advanced technology and other AWS managed solutions are natively integrated into the LAMP Platform and the Cortex data analysis toolkit, enabling both advanced clinical care management features (such as just-in-time adaptive interventions) and advanced research/data analysis methods. </p><p><strong>We are working closely with Amazon Web Services (AWS) to bring this feature to all organizations using the LAMP Platform. If you or your organization are interested, please contact us.</strong></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/BIDMCDigitalPsychiatry/LAMP-platform/edit/master/docs/07-deploy/05-aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-03T16:48:30.000Z">3/3/2022</time></b> by <b>Ashley Meyer</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/deploy/provisioning"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Provisioning the LAMP Platform</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/deploy/cloudformation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying via CloudFormation<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#for-ec2-instances-only" class="table-of-contents__link toc-highlight">For EC2 Instances Only:</a></li><li><a href="#ec2-commands" class="table-of-contents__link toc-highlight">EC2 Commands</a></li><li><a href="#aws-ssm-instructions" class="table-of-contents__link toc-highlight">AWS SSM Instructions</a></li><li><a href="#using-aws-documentdb-instead-of-mongodb-coming-soon" class="table-of-contents__link toc-highlight">Using AWS DocumentDB instead of MongoDB (Coming Soon)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2021 LAMP Consortium & Division of Digital Psychiatry @ BIDMC</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d014a8c0.js"></script>
<script src="/assets/js/main.b6df9aae.js"></script>
</body>
</html>